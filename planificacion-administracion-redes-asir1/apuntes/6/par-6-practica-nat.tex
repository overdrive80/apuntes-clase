\input{../../../common/plantilla-ejercicio.tex}
\usepackage{eurosym}


\renewcommand{\hmwkClass}{Planificación y Administración de Redes}
\renewcommand{\hmwkTitle}{Práctica de conexiones TCP}




\begin{document}

% \maketitle

% ----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
% ----------------------------------------------------------------------------------------

% \setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\primerapagina

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}


\section{Objetivo de la práctica}
Los objetivos  de la práctica son:
\begin{itemize}
\item Familiarizarse con los conceptos de puerto y conexión
\item Implementar NAT
\item Exponer servicios a través de un NAT
\end{itemize}


La última versión de esta práctica está disponible en \enlace{https://alvarogonzalezsotillo.github.io/apuntes-clase/planificacion-administracion-redes-asir1/apuntes/5/par-6-practica-nat.pdf}{este enlace}.


\section{Preparación del entorno}
\begin{itemize}
\item  Necesitas una máquina virtual Linux (recomendado Debian)
  \begin{itemize}
  \item No necesita mucha memoria (256 MBytes)
    
  \item Tendrá una tarjeta de red \textit{bridged} con la dirección \texttt{192.168.255.N} (siendo \texttt{N} tu número de ordenador)
  \item Tendrá una tarjeta de red \textit{bridged} con una IP en la red del aula, para la comunicación con Internet.
  \item Tendrá una tarjeta de red \textit{internal}, con una dirección privada clase B.

  \end{itemize}



\item Necesitas una máquina virtual Windows, versión \textit{profesional}, \textit{ultimate} o equivalente.
  \begin{itemize}
  \item  No necesita mucha memoria (256 MBytes)
  \item Tendrá una tarjeta de red \textit{internal} , con una dirección privada clase B
  \end{itemize}
\item c. Una máquina virtual Linux
  \begin{itemize}
  \item No necesita mucha memoria (256 MBytes)
  \item Tendrá una tarjeta de red \textit{internal}, con una dirección privada clase B
  \end{itemize}
  
\item  La máquina A, B y C deben poder conectarse a nivel IP por sus tarjetas \textit{internal}. A es el router por defecto de B y C.
\end{itemize}



\begin{homeworkProblem}[Activa el NAT en la máquina A (2 puntos)]
  \begin{itemize}
  \item Activa el flag de enrutamiento de Linux en A
  \item Desactiva NAT. Recuerda volver a desactivarlo y comenzar de cero cada vez que realices una prueba.
    \begin{comment}
      iptables -t nat –F
    \end{comment}
  \item Activa NAT. Puedes usar, entre otras, las instrucciones de \enlace{http://albertomolina.wordpress.com/2009/01/09/nat-con-iptables/}{albertomolina}, apartado \textit{Source NAT}
  \item Comprueba que las máquinas B y C pueden acceder a internet
  \end{itemize}
\end{homeworkProblem}

\begin{homeworkProblem}[Conectate a B por medio de escritorio remoto, desde tu PC físico (1 punto)]
  \begin{itemize}
    
  \item Busca qué puerto utiliza el protocolo RDP y ábrelo (\enlace{http://albertomolina.wordpress.com/2009/01/09/nat-con-iptables/}{albertomolina}, apartado prerouting)
  \item Activa el escritorio remoto en B (Propiedades del sistema->Remoto->Permitir escritorio remoto)
    
  \item Habilita algún usuario para que pueda conectarse por medio de escritorio remoto
  \item Conéctate desde tu PC físico con la orden \texttt{mstsc} en  Windows (o \texttt{rdesktop} si el ordenador físico tiene Linux)
  \end{itemize}

\end{homeworkProblem}


\begin{homeworkProblem}[Conectate a B desde el equipo B de otro compañero (1 punto)]
  Necesitarás repetir los pasos anteriores, pero para otra tarjeta de red (la de dirección \texttt{192.168.255.N}).
\end{homeworkProblem}


\begin{homeworkProblem}[Convierte a B en un servidor de ficheros (carpetas compartidas) (2 puntos)]
  \begin{itemize}
  \item los puertos necesarios en A para que pueda accederse a B como servidor de ficheros (\enlace{http://www.chicagotech.net/netforums/viewtopic.php?t=5067}{ayuda}).
  \item  Los puertos TCP se indican con el flag \texttt{-p tcp}. Los puertos UDP se indican con el flag \texttt{-p udp}.
    
  \item Comparte alguna carpeta en B. Recuerda que en Windows
    \begin{itemize}
    \item Es mejor desactivar “Utilizar el uso compartido simple de archivos”
    \item  El usuario que se utiliza para acceder remotamente debe tener contraseña
    \end{itemize}

  \end{itemize}

\end{homeworkProblem}


\begin{homeworkProblem}[Haz que A y C puedan ser administrados mediante SSH desde la red del aula (2 puntos)]
  \begin{itemize}
  \item Instala openssh-server en los dos ordenadores, si no está ya instalado.
  \item Abre los puertos necesarios para llegar a C desde la red del aula.
  \end{itemize}

\end{homeworkProblem}


\section{Normas de entrega}
\begin{itemize}
\item Avisa al profesor para que compruebe el funcionamiento de cada ejercicio. 
\item Se entregará una memoria con el formato acostumbrado. No es necesario explicar cada paso (en modo tutorial), solo demostrar que se han realizado las tareas.
\item La memoria incluirá

  \begin{itemize}
  \item un esquema de la red (2 puntos)
  \item las órdenes realizadas en el servidor Linux para conseguir realizar el NAT correctamente.
  \item Pantallazos que demuestren que se han realizado las tareas pedidas
  \item
    \begin{small}
Nota: Las órdenes que manejan NAT en Linux deben comenzar siempre desde la primera. Se recomienda hacer un script SH para las órdenes.
\end{small}

  \end{itemize}

\end{itemize}
\end{document}
