\input{../../../common/plantilla-ejercicio.tex}
\usepackage{eurosym}





\renewcommand{\hmwkTitle}{Usuarios y permisos}
\renewcommand{\hmwkClass}{ASGBD}

\usepackage{blindtext}

\begin{document}

% \maketitle

% ----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
% ----------------------------------------------------------------------------------------

% \setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

\primerapagina

\section{Objetivo de la práctica}
En esta práctica utilizaremos a la base de datos \textbf{Oracle} como un verdadero servidor, conectándonos desde otros ordenadores. Para ello:
\begin{itemize}
\item Necesitamos poner accesible por red nuestro servidor
\item Crearemos tablas en un \textit{tablespace} separado
\item Crearemos un usuario para cada compañero de clase
\item Asignaremos privilegios utilizando un rol
\end{itemize}

La última versión de este documento está accesible en \enlace{https://alvarogonzalezsotillo.github.io/apuntes-clase/sistemas-gestores-bbdd-asir2/apuntes/1/asbgd-1-practica-usuarios-permisos.pdf}{https://alvarogonzalezsotillo.github.io/apuntes-clase/sistemas-gestores-bbdd-asir2/apuntes/1/asbgd-1-practica-usuarios-permisos.pdf}

\begin{homeworkProblem}[: Poner Oracle disponible por red]

  Los demás compañeros deben poder acceder a nuestro servidor de \textbf{Oracle}. Para ello
  \begin{enumerate}
  \item La máquina virtual debe ser accedida desde el resto del aula. El tipo de conexión será \textit{bridged}
  \item \textbf{Centos} tiene activado un firewall. Hay que desactivarlo como se indica en
    \begin{itemize}
    \item  \url{https://www.liquidweb.com/kb/how-to-stop-and-disable-firewalld-on-centos-7/}
    \end{itemize}
    
  \item La dirección IP se asigna actualmente por DHCP. Esto es un inconveniente porque puede variar cada día. Es mejor utilizar un nombre, así que instalaremos \textbf{avahi}
    \begin{itemize}
    \item \url{https://en.wikipedia.org/wiki/Avahi\_(software)}
    \item Instalaremos repositorios de \textit{software} adicionales con \texttt{sudo yum install epel-release}
    \item Después, instalaremos \textbf{avahi} con \texttt{sudo yum install avahi avahi-tools nss-mdns}

    \end{itemize}

  \item Tu ordenador será accesible con el nombre \texttt{nombre-de-host.local}.
  \item Pide al profesor que añada el nombre de tu ordenador en la siguiente hoja de cálculo: \url{https://goo.gl/FnMmrM}
    
    
  \end{enumerate}

  Cuando tengas estos cambios, pide al profesor que compruebe que funcionan.
\end{homeworkProblem}


\begin{homeworkProblem}[: Crear usuarios para tus compañeros]

  Crea un usuario para tí, uno para cada uno de tus compañeros, y uno para el profesor. La contraseña inicial será la misma que el nombre, excepto en tu usuario que debería ser una contraseña secreta:
  \begin{multicols}{3}
    \begin{itemize}
    \item ANGEL
    \item BANEGAS
    \item BERMUDEZ
    \item BROWN
    \item CABRERA
    \item CALATRAVA
    \item DELMASTRO
    \item DZIERZAK
    \item EXTREMO
    \item FERNANDEZ
    \item FRONTELO
    \item GARCIA
    \item GUINEA
    \item IRUELA
    \item LOZANO
    \item LUENGO
    \item MONTERO
    \item MORALES
    \item PEREZ
    \item RIVERO
    \item RODRIGUEZ
    \item ROMERO
    \item ROSA
    \item SANTAREN
    \item UTRERO
    \item PROFESOR
    \end{itemize}
  \end{multicols}
  {\small \textbf{Nota}: Son muchos usuarios, así que es aconsejable utilizar un \textit{script} en vez de crearlos manualmente.}

  Los usuarios necesitarán el rol \texttt{connect}. Cuando tengas listos los usuarios:
  \begin{itemize}
    \item El resto de usuarios podrán conectarse con \texttt{sqlplus USUARIO/USUARIO@HOST:1521/asir}
    \item Pide al profesor que compruebe su usuario
    \item Pide a algunos compañeros que comprueben su usuario
  \end{itemize}
\end{homeworkProblem}

\begin{homeworkProblem}[: Creación de las tablas]
  Cambia la contraseña de tu usuario, si no lo has hecho ya, para que ningún compañero pueda utilizarlo (con \texttt{ALTER USER}).

  \begin{enumerate}
  \item Crea un \textit{tablespace} de nombre \texttt{multas}
  \item Con tu propio usuario, crea las tablas en ese \textit{tablespace}
    \begin{itemize}
    \item Utiliza el \enlace{https://alvarogonzalezsotillo.github.io/sistemas-gestores-bbdd-asir2/apuntes/2/sql/multas.sql}{\textit{script} \texttt{multas.sql} para la creación de las tablas}
    \item Tendrás que modificar el \textit{script} para que tenga en cuenta tu \textit{tablespace}
    \item Tu usuario deberá tener cuota en el \texttt{tablespace}
    \end{itemize}
  \end{enumerate}
\end{homeworkProblem}

\begin{homeworkProblem}[: Dar acceso a otros usuarios a un campo de tus tablas]
  Tras la importación, haz que las tablas puedan ser leidas por el resto de usuarios:
  \begin{itemize}
  \item Haz que el resto de usuarios pueda realizar \texttt{SELECT} sobre tus tablas.  
  \item Crea sinónimos en todos los usuarios para que puedan acceder a tus tablas sin problemas
    \begin{itemize}
    \item Por ejemplo, el usuario \texttt{profesor} debería poder ejecutar \texttt{SELECT * FROM MULTAS}, puesto que habrás creado un sinónimo del tipo \texttt{CREATE PUBLIC SYNONYM MULTAS FOR \textit{MIUSUARIO}.MULTAS}.
    \end{itemize}
  \end{itemize}

  Después, haz que puedan escribir en un campo de la tabla \texttt{MULTAS}:
  \begin{itemize}
  \item Crea un nuevo campo en la tabla \texttt{MULTAS}: \texttt{PAGADO}, de tipo \texttt{NUMBER(1,0)}. Tendrá el valor \texttt{1} si la multa ha sido pagada, y \texttt{0} en caso contrario (cláusula \texttt{DEFAULT} y \texttt{CHECK})
    
  \item Da permisos al resto de usuarios para poder escribir en este campo, con una orden \texttt{GRANT}
    \begin{itemize}
    \item \enlace{http://stackoverflow.com/questions/14462353/grant-alter-on-only-one-column-in-table}{http://stackoverflow.com/questions/14462353/grant-alter-on-only-one-column-in-table}
    \end{itemize}

  \item Pide a algún otro compañero que compruebe que funciona
  \item Pide al profesor que compruebe que funciona.

  \end{itemize}
  

\end{homeworkProblem}


\section{Instrucciones de entrega}
\begin{itemize}
\item Describe en una memoria todos los pasos que has necesitado para realizar la práctica. Incluye también los errores y como los has solucionado.
\item El ejercicio se realizará y entregará de manera individual.
  \begin{itemize}
  \item Solo se admiten trabajos en pareja, si en clase es necesario compartir ordenador.
  \end{itemize}
\item El profesor debe comprobar que tu base de datos funciona en clase. Pídele que lo revise cuando lo tengas listo.
\item Entrega tu trabajo en formato \textbf{doc}, \textbf{docx}, \textbf{odt} o \textbf{pdf}.
\item También puede entregarse como una entrada de blog. Para ello, sube un archivo con la URL de la entrada.
\item Sube el documento a la tarea correspondiente \enlace{https://aulavirtual3.educa.madrid.org/ies.alonsodeavellan.alcala/course/view.php?id=189}{en el aula virtual}
\item Presta atención al plazo de entrega (con fecha y hora).
  
\end{itemize}
\end{document}
